var k=(t,e,s)=>{if(!e.has(t))throw TypeError("Cannot "+s)};var c=(t,e,s)=>(k(t,e,"read from private field"),s?s.call(t):e.get(t)),d=(t,e,s)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,s)},p=(t,e,s,n)=>(k(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s);var m=(t,e,s)=>(k(t,e,"access private method"),s);import{S as Y,n as A,k as B,Q as J,l as ee,m as te,o as se,r as w,p as re,q as ne,s as ie,t as W,v as U,w as ue,x as ae,u as N,y as Z,z,A as G,D as V}from"./index.8f9897ef.js";function _(t,e){return t.filter(s=>!e.includes(s))}function oe(t,e,s){const n=t.slice(0);return n[e]=s,n}var v,q,C,f,E,P,F,T,x,K,S,L,H,j,M,$,D,ce=(D=class extends Y{constructor(e,s,n){super();d(this,F);d(this,x);d(this,S);d(this,H);d(this,M);d(this,v,void 0);d(this,q,void 0);d(this,C,void 0);d(this,f,void 0);d(this,E,void 0);d(this,P,void 0);p(this,v,e),p(this,C,[]),p(this,f,[]),m(this,F,T).call(this,[]),this.setQueries(s,n)}onSubscribe(){this.listeners.size===1&&c(this,f).forEach(e=>{e.subscribe(s=>{m(this,H,j).call(this,e,s)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,c(this,f).forEach(e=>{e.destroy()})}setQueries(e,s,n){p(this,C,e),p(this,E,s),A.batch(()=>{const r=c(this,f),i=m(this,S,L).call(this,c(this,C));i.forEach(h=>h.observer.setOptions(h.defaultedQueryOptions,n));const u=i.map(h=>h.observer),o=u.map(h=>h.getCurrentResult()),y=u.some((h,Q)=>h!==r[Q]);r.length===u.length&&!y||(p(this,f,u),m(this,F,T).call(this,o),this.hasListeners()&&(_(r,u).forEach(h=>{h.destroy()}),_(u,r).forEach(h=>{h.subscribe(Q=>{m(this,H,j).call(this,h,Q)})}),m(this,M,$).call(this)))})}getCurrentResult(){return c(this,P)}getQueries(){return c(this,f).map(e=>e.getCurrentQuery())}getObservers(){return c(this,f)}getOptimisticResult(e,s){const n=m(this,S,L).call(this,e),r=n.map(i=>i.observer.getOptimisticResult(i.defaultedQueryOptions));return[r,i=>m(this,x,K).call(this,i!=null?i:r,s),()=>n.map((i,u)=>{const o=r[u];return i.defaultedQueryOptions.notifyOnChangeProps?o:i.observer.trackResult(o)})]}},v=new WeakMap,q=new WeakMap,C=new WeakMap,f=new WeakMap,E=new WeakMap,P=new WeakMap,F=new WeakSet,T=function(e){var s;p(this,q,e),p(this,P,m(this,x,K).call(this,e,(s=c(this,E))==null?void 0:s.combine))},x=new WeakSet,K=function(e,s){return s?B(c(this,P),s(e)):e},S=new WeakSet,L=function(e){const s=c(this,f),n=new Map(s.map(a=>[a.options.queryHash,a])),r=e.map(a=>c(this,v).defaultQueryOptions(a)),i=r.flatMap(a=>{const g=n.get(a.queryHash);return g!=null?[{defaultedQueryOptions:a,observer:g}]:[]}),u=new Set(i.map(a=>a.defaultedQueryOptions.queryHash)),o=r.filter(a=>!u.has(a.queryHash)),y=a=>{const g=c(this,v).defaultQueryOptions(a),O=c(this,f).find(l=>l.options.queryHash===g.queryHash);return O!=null?O:new J(c(this,v),g)},h=o.map(a=>({defaultedQueryOptions:a,observer:y(a)})),Q=(a,g)=>r.indexOf(a.defaultedQueryOptions)-r.indexOf(g.defaultedQueryOptions);return i.concat(h).sort(Q)},H=new WeakSet,j=function(e,s){const n=c(this,f).indexOf(e);n!==-1&&(m(this,F,T).call(this,oe(c(this,q),n,s)),m(this,M,$).call(this))},M=new WeakSet,$=function(){A.batch(()=>{this.listeners.forEach(e=>{e(c(this,q))})})},D);function X({queries:t,...e},s){const n=ee(s),r=te(),i=se(),u=w.exports.useMemo(()=>t.map(l=>{const R=n.defaultQueryOptions(l);return R._optimisticResults=r?"isRestoring":"optimistic",R}),[t,n,r]);u.forEach(l=>{re(l),ne(l,i)}),ie(i);const[o]=w.exports.useState(()=>new ce(n,u,e)),[y,h,Q]=o.getOptimisticResult(u,e.combine);w.exports.useSyncExternalStore(w.exports.useCallback(l=>r?()=>{}:o.subscribe(A.batchCalls(l)),[o,r]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),w.exports.useEffect(()=>{o.setQueries(u,e,{listeners:!1})},[u,e,o]);const g=y.some((l,R)=>W(u[R],l))?y.flatMap((l,R)=>{const b=u[R];if(b){const I=new J(n,b);if(W(b,l))return U(b,I,i);ue(l,r)&&U(b,I,i)}return[]}):[];if(g.length>0)throw Promise.all(g);const O=y.find((l,R)=>{const b=u[R];return b&&ae({result:l,errorResetBoundary:i,throwOnError:b.throwOnError,query:n.getQueryCache().get(b.queryHash)})});if(O!=null&&O.error)throw O.error;return h(Q())}const fe=({organization:t,repository:e,tag:s,enabled:n})=>N({queryKey:["PrFromRefTag",t,e,s],refetchOnWindowFocus:!1,enabled:n,queryFn:async({queryKey:[,r,i,u]})=>await Z({organization:r,repository:i,tag:u}).then(({object:{sha:o}})=>z({organization:r,repository:i,tag:o}).then(y=>G({organization:r,repository:i,commit:y.object.sha}))).then(({items:[o]})=>o)}),de=(t,e,s)=>X({queries:t.map(n=>({queryKey:["PrFromRefTag",e,s,n],refetchOnWindowFocus:!1,queryFn:async()=>await Z({organization:e,repository:s,tag:n}).then(({object:{sha:r}})=>z({organization:e,repository:s,tag:r}).then(i=>G({organization:e,repository:s,commit:i.object.sha}))).then(({items:[r]})=>r)})),combine:n=>({data:n.map(r=>r.data),pending:n.some(r=>r.isPending),error:n.some(r=>r.isError)})}),me=({organization:t,repository:e,pullRequestNumber:s,enabled:n})=>N({queryKey:["CommentsFromPullRequest",t,e,s],enabled:n,queryFn:({queryKey:[,r,i,u]})=>V({organization:r,repository:i,pullRequestNumber:u})}),ge=({pullRequestNumbers:t,organization:e,repository:s,enabled:n})=>X({queries:t.map(r=>({queryKey:["CommentsFromPullRequest",e,s,r],enabled:n,queryFn:()=>V({organization:e,repository:s,pullRequestNumber:r})})),combine:r=>({data:r.map(i=>i.data),pending:r.some(i=>i.isPending),error:r.some(i=>i.isError)})}),ye=t=>t?t.number.toString():"",be=t=>t?t.html_url:"",pe=t=>[...new Set(t&&t.body?t.body.match(/([A-Z]+-\d+)/g):null)],Oe=t=>{if(!(t!=null&&t.body))return null;const e=/\\n|\\r|- |\n/gm,s=/(Changes in this PR:|Reason for the change\?)\r\n\r\n([\s\S]*?)(?=âœ‚|#|$)/,n=t==null?void 0:t.body.match(s);return(n&&n[2]||"").split(e).filter(i=>i.replace(e,"").trim().length>0)},Re=t=>!t||(t==null?void 0:t.length)===0?null:t==null?void 0:t.map(e=>{const s=e.body.match(/Allure report: (.*)/);return s?s[1]:!1}).filter(Boolean),Qe=(t,e,s)=>!!t&&!!e&&!!s?`https://github.com/${t}/${e}/releases/tag/${s}`:null;export{be as a,pe as b,Oe as c,me as d,Re as e,Qe as f,ye as g,de as h,ge as i,fe as u};
